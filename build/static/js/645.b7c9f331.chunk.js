"use strict";(self.webpackChunkelectro=self.webpackChunkelectro||[]).push([[645],{645:(e,s,r)=>{r.r(s),r.d(s,{default:()=>c});var i=r(43),a=r(579);const t="https://electro-a8bl.onrender.com/api";const c=function(e){let{onLogout:s}=e;const[r,c]=(0,i.useState)([]),[n,o]=(0,i.useState)([]),[l,d]=(0,i.useState)(!1),[h,p]=(0,i.useState)(""),[m,u]=(0,i.useState)(""),[x,j]=(0,i.useState)([]),[g,v]=(0,i.useState)(!1),[f,y]=(0,i.useState)({name:"",category:"",description:"",shortDescription:"",mainImage:"",variationType:"power"}),b=async()=>{try{d(!0);const e=await fetch(`${t}/products`),s=await e.json();c(s)}catch(e){p("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"),console.error(e)}finally{d(!1)}},N=async()=>{try{const e=await fetch(`${t}/master-products`),s=await e.json();j(s)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043c\u0430\u0441\u0442\u0435\u0440-\u0442\u043e\u0432\u0430\u0440\u043e\u0432:",e)}};(0,i.useEffect)(()=>{b(),N()},[]);const w=e=>{o(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return(0,a.jsxs)("div",{className:"product-merge",children:[(0,a.jsx)("div",{className:"product-merge-header",children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"}),(0,a.jsx)("p",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0442\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043c\u043e\u0449\u043d\u043e\u0441\u0442\u044c\u044e), \u0438 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u0435 \u0438\u0445 \u0432 \u043e\u0434\u0438\u043d \u0442\u043e\u0432\u0430\u0440 \u0441 \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u044f\u043c\u0438."})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/admin/products",style:{background:"#1976d2",color:"#fff",fontWeight:600,fontSize:15,border:"none",borderRadius:7,padding:"8px 18px",cursor:"pointer"},children:"\ud83d\udce6 \u0422\u043e\u0432\u0430\u0440\u044b"}),(0,a.jsx)("button",{onClick:()=>window.location.href="/admin/settings",style:{background:"#1e88e5",color:"#fff",fontWeight:600,fontSize:15,border:"none",borderRadius:7,padding:"8px 18px",cursor:"pointer"},children:"\u2699\ufe0f \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),(0,a.jsx)("button",{onClick:()=>window.location.href="/admin/pickup-points",style:{background:"#28a745",color:"#fff",fontWeight:600,fontSize:15,border:"none",borderRadius:7,padding:"8px 18px",cursor:"pointer"},children:"\ud83c\udfec \u041f\u0443\u043d\u043a\u0442\u044b \u0441\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437\u0430"}),(0,a.jsx)("button",{onClick:s,style:{background:"#e53935",color:"#fff",fontWeight:600,fontSize:15,border:"none",borderRadius:7,padding:"8px 18px",cursor:"pointer"},children:"\u0412\u044b\u0439\u0442\u0438"})]})]})}),h&&(0,a.jsxs)("div",{className:"error-message",children:[h,(0,a.jsx)("button",{onClick:()=>p(""),children:"\xd7"})]}),m&&(0,a.jsxs)("div",{className:"success-message",children:[m,(0,a.jsx)("button",{onClick:()=>u(""),children:"\xd7"})]}),(0,a.jsxs)("div",{className:"product-merge-content",children:[(0,a.jsxs)("div",{className:"product-merge-section",children:[(0,a.jsxs)("div",{className:"section-header",children:[(0,a.jsx)("h2",{children:"\u0412\u044b\u0431\u043e\u0440 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043b\u044f \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"}),(0,a.jsxs)("div",{className:"section-actions",children:[(0,a.jsx)("button",{onClick:()=>{n.length===r.length?o([]):o(r.map(e=>e._id))},className:"btn-secondary",children:n.length===r.length?"\u0421\u043d\u044f\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435":"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435"}),(0,a.jsxs)("button",{onClick:()=>{if(n.length<2)return void p("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043c\u0438\u043d\u0438\u043c\u0443\u043c 2 \u0442\u043e\u0432\u0430\u0440\u0430 \u0434\u043b\u044f \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f");const e=r.filter(e=>n.includes(e._id))[0];y({name:e.name.replace(/\d+\s*[\u0412\u0442W]/i,"").trim(),category:e.category||"",description:e.description||"",shortDescription:e["Short description"]||"",mainImage:e.image||"",variationType:"power"}),v(!0),p("")},disabled:n.length<2||l,className:"btn-primary",children:["\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 (",n.length,")"]})]})]}),l?(0,a.jsx)("div",{className:"loading",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432..."}):(0,a.jsx)("div",{className:"products-grid",children:r.map(e=>(0,a.jsxs)("div",{className:"product-card "+(n.includes(e._id)?"selected":""),onClick:()=>w(e._id),children:[(0,a.jsx)("div",{className:"product-image",children:(0,a.jsx)("img",{src:e.image||"/images/products/placeholder.png",alt:e.name})}),(0,a.jsxs)("div",{className:"product-info",children:[(0,a.jsx)("h3",{children:e.name}),(0,a.jsxs)("p",{className:"product-price",children:[e.price," \u20b8"]}),(0,a.jsxs)("p",{className:"product-article",children:["\u0410\u0440\u0442\u0438\u043a\u0443\u043b: ",e.article||"\u041d\u0435\u0442"]}),e.characteristics&&(0,a.jsxs)("div",{className:"product-characteristics",children:[(0,a.jsx)("small",{children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438:"}),(0,a.jsx)("div",{className:"characteristics-preview",children:"string"===typeof e.characteristics?e.characteristics.substring(0,100)+"...":JSON.stringify(e.characteristics).substring(0,100)+"..."})]})]}),(0,a.jsx)("div",{className:"product-checkbox",children:(0,a.jsx)("input",{type:"checkbox",checked:n.includes(e._id),onChange:()=>w(e._id),onClick:e=>e.stopPropagation()})})]},e._id))})]}),g&&(0,a.jsx)("div",{className:"merge-form-overlay",children:(0,a.jsxs)("div",{className:"merge-form",children:[(0,a.jsxs)("div",{className:"form-header",children:[(0,a.jsx)("h2",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"}),(0,a.jsx)("button",{onClick:()=>v(!1),children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{d(!0),p("");const e=await fetch(`${t}/merge-products`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productIds:n,masterProductData:f,variationType:f.variationType})}),s=await e.json();if(!e.ok)throw new Error(s.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u043e\u0432");u(s.message),o([]),v(!1),y({name:"",category:"",description:"",shortDescription:"",mainImage:"",variationType:"power"}),await b(),await N(),setTimeout(()=>u(""),3e3)}catch(s){p(s.message)}finally{d(!1)}},children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0430\u0441\u0442\u0435\u0440-\u0442\u043e\u0432\u0430\u0440\u0430:"}),(0,a.jsx)("input",{type:"text",value:f.name,onChange:e=>y(s=>({...s,name:e.target.value})),required:!0,placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0423\u0433\u043b\u043e\u0432\u0430\u044f \u0448\u043b\u0438\u0444\u043e\u0432\u0430\u043b\u044c\u043d\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u0430"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f:"}),(0,a.jsx)("input",{type:"text",value:f.category,onChange:e=>y(s=>({...s,category:e.target.value})),required:!0,placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0411\u043e\u043b\u0433\u0430\u0440\u043a\u0430"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"\u0422\u0438\u043f \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0438:"}),(0,a.jsxs)("select",{value:f.variationType,onChange:e=>y(s=>({...s,variationType:e.target.value})),children:[(0,a.jsx)("option",{value:"power",children:"\u041c\u043e\u0449\u043d\u043e\u0441\u0442\u044c (\u0412\u0442)"}),(0,a.jsx)("option",{value:"voltage",children:"\u041d\u0430\u043f\u0440\u044f\u0436\u0435\u043d\u0438\u0435 (\u0412)"}),(0,a.jsx)("option",{value:"size",children:"\u0420\u0430\u0437\u043c\u0435\u0440"}),(0,a.jsx)("option",{value:"color",children:"\u0426\u0432\u0435\u0442"}),(0,a.jsx)("option",{value:"custom",children:"\u0414\u0440\u0443\u0433\u043e\u0435"})]})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:"}),(0,a.jsx)("textarea",{value:f.description,onChange:e=>y(s=>({...s,description:e.target.value})),placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430",rows:"3"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"\u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:"}),(0,a.jsx)("textarea",{value:f.shortDescription,onChange:e=>y(s=>({...s,shortDescription:e.target.value})),placeholder:"\u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",rows:"2"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"\u0413\u043b\u0430\u0432\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435:"}),(0,a.jsx)("input",{type:"text",value:f.mainImage,onChange:e=>y(s=>({...s,mainImage:e.target.value})),placeholder:"URL \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"})]}),(0,a.jsxs)("div",{className:"selected-products-preview",children:[(0,a.jsxs)("h4",{children:["\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b (",n.length,"):"]}),(0,a.jsx)("div",{className:"selected-products-list",children:r.filter(e=>n.includes(e._id)).map(e=>(0,a.jsxs)("div",{className:"selected-product-item",children:[(0,a.jsx)("img",{src:e.image||"/images/products/placeholder.png",alt:e.name}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:e.name}),(0,a.jsxs)("span",{children:[e.price," \u20b8"]})]})]},e._id))})]}),(0,a.jsxs)("div",{className:"form-actions",children:[(0,a.jsx)("button",{type:"button",onClick:()=>v(!1),className:"btn-secondary",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,a.jsx)("button",{type:"submit",disabled:l,className:"btn-primary",children:l?"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435...":"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440\u044b"})]})]})]})}),(0,a.jsxs)("div",{className:"product-merge-section",children:[(0,a.jsx)("h2",{children:"\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043c\u0430\u0441\u0442\u0435\u0440-\u0442\u043e\u0432\u0430\u0440\u044b"}),0===x.length?(0,a.jsx)("p",{children:"\u041f\u043e\u043a\u0430 \u043d\u0435\u0442 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"}):(0,a.jsx)("div",{className:"master-products-list",children:x.map(e=>(0,a.jsxs)("div",{className:"master-product-card",children:[(0,a.jsxs)("div",{className:"master-product-info",children:[(0,a.jsx)("h3",{children:e.name}),(0,a.jsxs)("p",{children:["\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f: ",e.category]}),(0,a.jsxs)("p",{children:["\u0422\u0438\u043f\u044b \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0439: ",e.variationTypes.join(", ")]}),(0,a.jsxs)("p",{children:["\u0421\u043e\u0437\u0434\u0430\u043d: ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,a.jsx)("div",{className:"master-product-actions",children:(0,a.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u043c\u0430\u0441\u0442\u0435\u0440-\u0442\u043e\u0432\u0430\u0440 \u0438 \u0432\u0441\u0435 \u0435\u0433\u043e \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0438?"))try{const s=await fetch(`${t}/master-products/${e}`,{method:"DELETE"});if(!s.ok){const e=await s.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f")}u("\u041c\u0430\u0441\u0442\u0435\u0440-\u0442\u043e\u0432\u0430\u0440 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d"),await N(),setTimeout(()=>u(""),3e3)}catch(s){p(s.message)}})(e._id),className:"btn-danger",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})]},e._id))})]})]})]})}}}]);
//# sourceMappingURL=645.b7c9f331.chunk.js.map