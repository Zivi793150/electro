{"version":3,"file":"static/js/645.b7c9f331.chunk.js","mappings":"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","sources":["admin/ProductMerge.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './ProductMerge.css';\r\n\r\nconst API_URL = 'https://electro-a8bl.onrender.com/api';\r\n\r\nfunction ProductMerge({ onLogout }) {\r\n  const [products, setProducts] = useState([]);\r\n  const [selectedProducts, setSelectedProducts] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [masterProducts, setMasterProducts] = useState([]);\r\n  const [showMergeForm, setShowMergeForm] = useState(false);\r\n  const [mergeFormData, setMergeFormData] = useState({\r\n    name: '',\r\n    category: '',\r\n    description: '',\r\n    shortDescription: '',\r\n    mainImage: '',\r\n    variationType: 'power'\r\n  });\r\n\r\n  // Загрузка всех товаров\r\n  const fetchProducts = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch(`${API_URL}/products`);\r\n      const data = await response.json();\r\n      setProducts(data);\r\n    } catch (err) {\r\n      setError('Ошибка загрузки товаров');\r\n      console.error(err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Загрузка мастер-товаров\r\n  const fetchMasterProducts = async () => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/master-products`);\r\n      const data = await response.json();\r\n      setMasterProducts(data);\r\n    } catch (err) {\r\n      console.error('Ошибка загрузки мастер-товаров:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n    fetchMasterProducts();\r\n  }, []);\r\n\r\n  // Выбор товара\r\n  const handleProductSelect = (productId) => {\r\n    setSelectedProducts(prev => {\r\n      if (prev.includes(productId)) {\r\n        return prev.filter(id => id !== productId);\r\n      } else {\r\n        return [...prev, productId];\r\n      }\r\n    });\r\n  };\r\n\r\n  // Выбор всех товаров\r\n  const handleSelectAll = () => {\r\n    if (selectedProducts.length === products.length) {\r\n      setSelectedProducts([]);\r\n    } else {\r\n      setSelectedProducts(products.map(p => p._id));\r\n    }\r\n  };\r\n\r\n  // Открытие формы объединения\r\n  const handleMergeClick = () => {\r\n    if (selectedProducts.length < 2) {\r\n      setError('Выберите минимум 2 товара для объединения');\r\n      return;\r\n    }\r\n    \r\n    const selectedProductObjects = products.filter(p => selectedProducts.includes(p._id));\r\n    \r\n    // Автоматически заполняем форму данными первого товара\r\n    const firstProduct = selectedProductObjects[0];\r\n    setMergeFormData({\r\n      name: firstProduct.name.replace(/\\d+\\s*[ВтW]/i, '').trim(), // Убираем мощность из названия\r\n      category: firstProduct.category || '',\r\n      description: firstProduct.description || '',\r\n      shortDescription: firstProduct['Short description'] || '',\r\n      mainImage: firstProduct.image || '',\r\n      variationType: 'power'\r\n    });\r\n    \r\n    setShowMergeForm(true);\r\n    setError('');\r\n  };\r\n\r\n  // Объединение товаров\r\n  const handleMergeSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      setLoading(true);\r\n      setError('');\r\n      \r\n      const response = await fetch(`${API_URL}/merge-products`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          productIds: selectedProducts,\r\n          masterProductData: mergeFormData,\r\n          variationType: mergeFormData.variationType\r\n        })\r\n      });\r\n      \r\n      const data = await response.json();\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Ошибка объединения товаров');\r\n      }\r\n      \r\n      setSuccess(data.message);\r\n      setSelectedProducts([]);\r\n      setShowMergeForm(false);\r\n      setMergeFormData({\r\n        name: '',\r\n        category: '',\r\n        description: '',\r\n        shortDescription: '',\r\n        mainImage: '',\r\n        variationType: 'power'\r\n      });\r\n      \r\n      // Обновляем списки\r\n      await fetchProducts();\r\n      await fetchMasterProducts();\r\n      \r\n      // Очищаем сообщение об успехе через 3 секунды\r\n      setTimeout(() => setSuccess(''), 3000);\r\n      \r\n    } catch (err) {\r\n      setError(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Удаление мастер-товара\r\n  const handleDeleteMasterProduct = async (masterProductId) => {\r\n    if (!window.confirm('Вы уверены, что хотите удалить этот мастер-товар и все его вариации?')) {\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const response = await fetch(`${API_URL}/master-products/${masterProductId}`, {\r\n        method: 'DELETE'\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        const data = await response.json();\r\n        throw new Error(data.error || 'Ошибка удаления');\r\n      }\r\n      \r\n      setSuccess('Мастер-товар успешно удален');\r\n      await fetchMasterProducts();\r\n      \r\n      setTimeout(() => setSuccess(''), 3000);\r\n    } catch (err) {\r\n      setError(err.message);\r\n    }\r\n  };\r\n\r\n  // Получение выбранных товаров\r\n  const getSelectedProductObjects = () => {\r\n    return products.filter(p => selectedProducts.includes(p._id));\r\n  };\r\n\r\n  return (\r\n    <div className=\"product-merge\">\r\n      <div className=\"product-merge-header\">\r\n        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 20}}>\r\n          <div>\r\n            <h1>Объединение товаров</h1>\r\n            <p>Выберите товары, которые отличаются только параметрами (например, мощностью), и объедините их в один товар с вариациями.</p>\r\n          </div>\r\n          <div style={{display: 'flex', gap: 10}}>\r\n            <button \r\n              onClick={() => window.location.href = '/admin/products'} \r\n              style={{\r\n                background: '#1976d2', \r\n                color: '#fff', \r\n                fontWeight: 600, \r\n                fontSize: 15, \r\n                border: 'none', \r\n                borderRadius: 7, \r\n                padding: '8px 18px', \r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              📦 Товары\r\n            </button>\r\n            <button \r\n              onClick={() => window.location.href = '/admin/settings'} \r\n              style={{\r\n                background: '#1e88e5', \r\n                color: '#fff', \r\n                fontWeight: 600, \r\n                fontSize: 15, \r\n                border: 'none', \r\n                borderRadius: 7, \r\n                padding: '8px 18px', \r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              ⚙️ Настройки\r\n            </button>\r\n            <button \r\n              onClick={() => window.location.href = '/admin/pickup-points'} \r\n              style={{\r\n                background: '#28a745', \r\n                color: '#fff', \r\n                fontWeight: 600, \r\n                fontSize: 15, \r\n                border: 'none', \r\n                borderRadius: 7, \r\n                padding: '8px 18px', \r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              🏬 Пункты самовывоза\r\n            </button>\r\n            <button \r\n              onClick={onLogout} \r\n              style={{\r\n                background: '#e53935', \r\n                color: '#fff', \r\n                fontWeight: 600, \r\n                fontSize: 15, \r\n                border: 'none', \r\n                borderRadius: 7, \r\n                padding: '8px 18px', \r\n                cursor: 'pointer'\r\n              }}\r\n            >\r\n              Выйти\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"error-message\">\r\n          {error}\r\n          <button onClick={() => setError('')}>&times;</button>\r\n        </div>\r\n      )}\r\n\r\n      {success && (\r\n        <div className=\"success-message\">\r\n          {success}\r\n          <button onClick={() => setSuccess('')}>&times;</button>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"product-merge-content\">\r\n        <div className=\"product-merge-section\">\r\n          <div className=\"section-header\">\r\n            <h2>Выбор товаров для объединения</h2>\r\n            <div className=\"section-actions\">\r\n              <button \r\n                onClick={handleSelectAll}\r\n                className=\"btn-secondary\"\r\n              >\r\n                {selectedProducts.length === products.length ? 'Снять выделение' : 'Выбрать все'}\r\n              </button>\r\n              <button \r\n                onClick={handleMergeClick}\r\n                disabled={selectedProducts.length < 2 || loading}\r\n                className=\"btn-primary\"\r\n              >\r\n                Объединить выбранные ({selectedProducts.length})\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {loading ? (\r\n            <div className=\"loading\">Загрузка товаров...</div>\r\n          ) : (\r\n            <div className=\"products-grid\">\r\n              {products.map(product => (\r\n                <div \r\n                  key={product._id} \r\n                  className={`product-card ${selectedProducts.includes(product._id) ? 'selected' : ''}`}\r\n                  onClick={() => handleProductSelect(product._id)}\r\n                >\r\n                  <div className=\"product-image\">\r\n                    <img src={product.image || '/images/products/placeholder.png'} alt={product.name} />\r\n                  </div>\r\n                  <div className=\"product-info\">\r\n                    <h3>{product.name}</h3>\r\n                    <p className=\"product-price\">{product.price} ₸</p>\r\n                    <p className=\"product-article\">Артикул: {product.article || 'Нет'}</p>\r\n                    {product.characteristics && (\r\n                      <div className=\"product-characteristics\">\r\n                        <small>Характеристики:</small>\r\n                        <div className=\"characteristics-preview\">\r\n                          {typeof product.characteristics === 'string' \r\n                            ? product.characteristics.substring(0, 100) + '...'\r\n                            : JSON.stringify(product.characteristics).substring(0, 100) + '...'\r\n                          }\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"product-checkbox\">\r\n                    <input \r\n                      type=\"checkbox\" \r\n                      checked={selectedProducts.includes(product._id)}\r\n                      onChange={() => handleProductSelect(product._id)}\r\n                      onClick={(e) => e.stopPropagation()}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {showMergeForm && (\r\n          <div className=\"merge-form-overlay\">\r\n            <div className=\"merge-form\">\r\n              <div className=\"form-header\">\r\n                <h2>Настройки объединения</h2>\r\n                <button onClick={() => setShowMergeForm(false)}>&times;</button>\r\n              </div>\r\n              \r\n              <form onSubmit={handleMergeSubmit}>\r\n                <div className=\"form-group\">\r\n                  <label>Название мастер-товара:</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={mergeFormData.name}\r\n                    onChange={(e) => setMergeFormData(prev => ({ ...prev, name: e.target.value }))}\r\n                    required\r\n                    placeholder=\"Например: Угловая шлифовальная машина\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Категория:</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={mergeFormData.category}\r\n                    onChange={(e) => setMergeFormData(prev => ({ ...prev, category: e.target.value }))}\r\n                    required\r\n                    placeholder=\"Например: Болгарка\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Тип вариации:</label>\r\n                  <select\r\n                    value={mergeFormData.variationType}\r\n                    onChange={(e) => setMergeFormData(prev => ({ ...prev, variationType: e.target.value }))}\r\n                  >\r\n                    <option value=\"power\">Мощность (Вт)</option>\r\n                    <option value=\"voltage\">Напряжение (В)</option>\r\n                    <option value=\"size\">Размер</option>\r\n                    <option value=\"color\">Цвет</option>\r\n                    <option value=\"custom\">Другое</option>\r\n                  </select>\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Описание:</label>\r\n                  <textarea\r\n                    value={mergeFormData.description}\r\n                    onChange={(e) => setMergeFormData(prev => ({ ...prev, description: e.target.value }))}\r\n                    placeholder=\"Описание товара\"\r\n                    rows=\"3\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Краткое описание:</label>\r\n                  <textarea\r\n                    value={mergeFormData.shortDescription}\r\n                    onChange={(e) => setMergeFormData(prev => ({ ...prev, shortDescription: e.target.value }))}\r\n                    placeholder=\"Краткое описание\"\r\n                    rows=\"2\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <label>Главное изображение:</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={mergeFormData.mainImage}\r\n                    onChange={(e) => setMergeFormData(prev => ({ ...prev, mainImage: e.target.value }))}\r\n                    placeholder=\"URL изображения\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"selected-products-preview\">\r\n                  <h4>Выбранные товары ({selectedProducts.length}):</h4>\r\n                  <div className=\"selected-products-list\">\r\n                    {getSelectedProductObjects().map(product => (\r\n                      <div key={product._id} className=\"selected-product-item\">\r\n                        <img src={product.image || '/images/products/placeholder.png'} alt={product.name} />\r\n                        <div>\r\n                          <strong>{product.name}</strong>\r\n                          <span>{product.price} ₸</span>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\">\r\n                  <button type=\"button\" onClick={() => setShowMergeForm(false)} className=\"btn-secondary\">\r\n                    Отмена\r\n                  </button>\r\n                  <button type=\"submit\" disabled={loading} className=\"btn-primary\">\r\n                    {loading ? 'Объединение...' : 'Объединить товары'}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"product-merge-section\">\r\n          <h2>Существующие мастер-товары</h2>\r\n          {masterProducts.length === 0 ? (\r\n            <p>Пока нет объединенных товаров</p>\r\n          ) : (\r\n            <div className=\"master-products-list\">\r\n              {masterProducts.map(masterProduct => (\r\n                <div key={masterProduct._id} className=\"master-product-card\">\r\n                  <div className=\"master-product-info\">\r\n                    <h3>{masterProduct.name}</h3>\r\n                    <p>Категория: {masterProduct.category}</p>\r\n                    <p>Типы вариаций: {masterProduct.variationTypes.join(', ')}</p>\r\n                    <p>Создан: {new Date(masterProduct.createdAt).toLocaleDateString()}</p>\r\n                  </div>\r\n                  <div className=\"master-product-actions\">\r\n                    <button \r\n                      onClick={() => handleDeleteMasterProduct(masterProduct._id)}\r\n                      className=\"btn-danger\"\r\n                    >\r\n                      Удалить\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProductMerge; "],"names":["API_URL","_ref","onLogout","products","setProducts","useState","selectedProducts","setSelectedProducts","loading","setLoading","error","setError","success","setSuccess","masterProducts","setMasterProducts","showMergeForm","setShowMergeForm","mergeFormData","setMergeFormData","name","category","description","shortDescription","mainImage","variationType","fetchProducts","async","response","fetch","data","json","err","console","fetchMasterProducts","useEffect","handleProductSelect","productId","prev","includes","filter","id","_jsxs","className","children","_jsx","style","display","justifyContent","alignItems","marginBottom","gap","onClick","window","location","href","background","color","fontWeight","fontSize","border","borderRadius","padding","cursor","handleSelectAll","length","map","p","_id","handleMergeClick","firstProduct","replace","trim","image","disabled","product","src","alt","price","article","characteristics","substring","JSON","stringify","type","checked","onChange","e","stopPropagation","onSubmit","preventDefault","method","headers","body","productIds","masterProductData","ok","Error","message","setTimeout","value","target","required","placeholder","rows","masterProduct","variationTypes","join","Date","createdAt","toLocaleDateString","confirm","masterProductId","handleDeleteMasterProduct"],"sourceRoot":""}